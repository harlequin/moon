"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[19050],{29146:(e,t,n)=>{n.d(t,{A:()=>o});const o=n.p+"assets/images/v0.50-de9e7e6b9a4f4bebfe1cc809e6d4ae58.png"},43023:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>a});var o=n(63696);const i={},r=o.createContext(i);function s(e){const t=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(r.Provider,{value:t},e.children)}},85082:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var o=n(93335),i=n(62540),r=n(43023);const s={slug:"proto-v0.50",title:"proto v0.50 - URL rewrites, on-init activation, preserved comments, and more",authors:["milesj"],tags:["rewrite","url","activation","comments","config","plugin","shell"],image:"./img/proto/v0.50.png"},a=void 0,l={image:n(29146).A,authorsImageUrls:[void 0]},d=[{value:"Rewrite URLs for better interoperability",id:"rewrite-urls-for-better-interoperability",level:2},{value:"Activation flow now triggers immediately",id:"activation-flow-now-triggers-immediately",level:2},{value:"Comments are now preserved in <code>.prototools</code>",id:"comments-are-now-preserved-in-prototools",level:2},{value:"Plugin commands are now executed within a shell",id:"plugin-commands-are-now-executed-within-a-shell",level:2},{value:"Other changes",id:"other-changes",level:2}];function c(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"In this release, we're landing a handful of quality of life improvements that have been requested by\nthe community."}),"\n",(0,i.jsx)(t.h2,{id:"rewrite-urls-for-better-interoperability",children:"Rewrite URLs for better interoperability"}),"\n",(0,i.jsx)(t.p,{children:"proto is heavily reliant on URLs, as they power everything from tool and plugin downloading to\nversion resolving. Many URLs are hard-coded into proto but most of them come from plugins. For the\nmost part this is fine, but if you work within a corporate environment, or have a firewall, you may\nhave to deal with proxy servers, mirrors, or other factors."}),"\n",(0,i.jsxs)(t.p,{children:["Until now, this was very difficult to circumvent, so we wanted to provide a built-in solution to\nthis problem, and as such, we're introducing the new\n",(0,i.jsx)(t.a,{href:"/docs/proto/config#url-rewrites",children:(0,i.jsx)(t.code,{children:"url-rewrites"})})," configuration setting. This setting accepts a map\nof regex patterns to replacements, and will rewrite URLs that match the pattern."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-toml",metastring:'title=".prototools"',children:'[settings.url-rewrites]\n"github.com/(\\\\w+)/(\\\\w+)" = "gh-mirror.corp.com/$1/$2"\n"mo+n" = "lunar"\n'})}),"\n",(0,i.jsxs)(t.p,{children:["For example, in the configuration above, any URL that contains ",(0,i.jsx)(t.code,{children:"github.com"})," will be replaced with\n",(0,i.jsx)(t.code,{children:"gh-mirror.corp.com"}),', and any URL that contains the word "moon" (with different length o\'s) will be\nreplaced with "lunar". Learn more about URL rewriting in the settings documentation!']}),"\n",(0,i.jsx)(t.h2,{id:"activation-flow-now-triggers-immediately",children:"Activation flow now triggers immediately"}),"\n",(0,i.jsxs)(t.p,{children:["Our ",(0,i.jsx)(t.a,{href:"/docs/proto/workflows#shell-activation",children:"activation flow"})," (shell hooks) is seeing more and more\nusage, with improved stability, but based on feedback we've received, there was still some pain\npoints. One of these pain points was that activation would not trigger immediately (new terminal\nwindow/tab), and would only trigger after changing directories."]}),"\n",(0,i.jsxs)(t.p,{children:["There was a way around this using the ",(0,i.jsx)(t.code,{children:"--on-init"})," flag, but that was not easily discoverable, and\nthe setup as a whole was not very intuitive. With this release, that flag has been deprecated and\nthe activation flow now triggers immediately, so you can start using your tools right away."]}),"\n",(0,i.jsx)(t.p,{children:"Historically we've been hesitent to do this, as we were worried about potential performance hits\nwhen having to download WASM plugins, or refetch caches. However in practice this has not been an\nissue."}),"\n",(0,i.jsxs)(t.h2,{id:"comments-are-now-preserved-in-prototools",children:["Comments are now preserved in ",(0,i.jsx)(t.code,{children:".prototools"})]}),"\n",(0,i.jsxs)(t.p,{children:["This has been a long standing issue and a long requested feature, and it's finally here! Comments\nare now preserved in ",(0,i.jsx)(t.code,{children:".prototools"})," files, and they'll no longer be removed when running ",(0,i.jsx)(t.code,{children:"proto"}),"\ncommands that modify these files (like ",(0,i.jsx)(t.a,{href:"/docs/proto/commands/alias",children:(0,i.jsx)(t.code,{children:"proto alias"})})," or\n",(0,i.jsx)(t.a,{href:"/docs/proto/commands/pin",children:(0,i.jsx)(t.code,{children:"proto pin"})}),")."]}),"\n",(0,i.jsx)(t.p,{children:"Historically this has been a hard problem to solve, as Rust serde (serialization/deserialization\nlibrary) strips comments when deserializing (reading) the file. To solve this problem, we had to\navoid serde, and operate on an AST-like structure instead. Because of this, we lose type-safety and\nthere may be some edge cases not accounted for."}),"\n",(0,i.jsx)(t.h2,{id:"plugin-commands-are-now-executed-within-a-shell",children:"Plugin commands are now executed within a shell"}),"\n",(0,i.jsxs)(t.p,{children:["When a plugin executes a command (child process) on the host system (your computer), it now executes\nit within a shell, e.g. ",(0,i.jsx)(t.code,{children:'bash -c "command"'}),". This change was made to ensure environment variables\n(like ",(0,i.jsx)(t.code,{children:"PATH"}),"), aliases, and other shell features that you have configured are available to the\nplugin."]}),"\n",(0,i.jsxs)(t.p,{children:["By default the shell to use is detected from the parent host process, but you can override it with\nthe ",(0,i.jsx)(t.code,{children:"PROTO_SHELL"})," environment variable. For example, to use ",(0,i.jsx)(t.code,{children:"zsh"})," you can set:"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-shell",children:"PROTO_SHELL=zsh\n"})}),"\n",(0,i.jsx)(t.h2,{id:"other-changes",children:"Other changes"}),"\n",(0,i.jsxs)(t.p,{children:["View the ",(0,i.jsx)(t.a,{href:"https://github.com/moonrepo/proto/releases/tag/v0.50.0",children:"official release"})," for a full list\nof changes."]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Added ",(0,i.jsx)(t.code,{children:"--dir"})," and ",(0,i.jsx)(t.code,{children:"--all"})," options to the ",(0,i.jsx)(t.a,{href:"/docs/proto/commands/bin",children:(0,i.jsx)(t.code,{children:"proto bin"})})," command."]}),"\n",(0,i.jsxs)(t.li,{children:["Added environment variable support to many non-tool related ",(0,i.jsx)(t.code,{children:".prototools"})," settings."]}),"\n",(0,i.jsxs)(t.li,{children:["Updated ",(0,i.jsx)(t.code,{children:"proto install <tool>"})," (without version) to install a version pinned in ",(0,i.jsx)(t.code,{children:".prototools"}),",\ninstead of the latest version."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},93335:e=>{e.exports=JSON.parse('{"permalink":"/blog/proto-v0.50","editUrl":"https://github.com/moonrepo/moon/tree/master/website/blog/2025-06-11_proto-v0.50.mdx","source":"@site/blog/2025-06-11_proto-v0.50.mdx","title":"proto v0.50 - URL rewrites, on-init activation, preserved comments, and more","description":"In this release, we\'re landing a handful of quality of life improvements that have been requested by","date":"2025-06-11T00:00:00.000Z","tags":[{"inline":true,"label":"rewrite","permalink":"/blog/tags/rewrite"},{"inline":true,"label":"url","permalink":"/blog/tags/url"},{"inline":true,"label":"activation","permalink":"/blog/tags/activation"},{"inline":true,"label":"comments","permalink":"/blog/tags/comments"},{"inline":true,"label":"config","permalink":"/blog/tags/config"},{"inline":true,"label":"plugin","permalink":"/blog/tags/plugin"},{"inline":true,"label":"shell","permalink":"/blog/tags/shell"}],"readingTime":3.05,"hasTruncateMarker":true,"authors":[{"name":"Miles Johnson","title":"Founder, developer","url":"https://github.com/milesj","imageURL":"/img/authors/miles.jpg","key":"milesj","page":null}],"frontMatter":{"slug":"proto-v0.50","title":"proto v0.50 - URL rewrites, on-init activation, preserved comments, and more","authors":["milesj"],"tags":["rewrite","url","activation","comments","config","plugin","shell"],"image":"./img/proto/v0.50.png"},"unlisted":false,"prevItem":{"title":"moon v1.38 - Go WASM toolchain, MCP tools, terminal notifications, and more!","permalink":"/blog/moon-v1.38"},"nextItem":{"title":"moon v1.37 - Rust WASM toolchain and MCP support","permalink":"/blog/moon-v1.37"}}')}}]);